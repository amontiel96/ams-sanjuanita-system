{
    "sourceFile": "src/Modelo/ClsMCompra.java",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1723876451620,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1723876451620,
            "name": "Commit-0",
            "content": "/*\r\n * To change this license header, choose License Headers in Project Properties.\r\n * To change this template file, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\npackage Modelo;\r\n\r\nimport Vista.*;\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\nimport java.util.logging.Level;\r\nimport java.util.logging.Logger;\r\nimport javax.swing.DefaultComboBoxModel;\r\nimport javax.swing.JOptionPane;\r\nimport javax.swing.table.DefaultTableModel;\r\nimport Controlador.*;\r\n\r\n/**\r\n *\r\n * @author Arturo\r\n */\r\npublic class ClsMCompra {\r\n String buscar,idventa,idpro,nombre,idprove,em=\"345\";\r\nint canAgregar;\r\n    public String getIdprove() {\r\n        return idprove;\r\n    }\r\n\r\n    public void setIdprove(String idprove) {\r\n        this.idprove = idprove;\r\n    }\r\nInteger cont,existencia;\r\n\r\n    public Integer getExistencia() {\r\n        return existencia;\r\n    }\r\n\r\n    public void setExistencia(Integer existencia) {\r\n        this.existencia = existencia;\r\n    }\r\n\r\n    public Integer getCont() {\r\n        return cont;\r\n    }\r\n\r\n    public void setCont(Integer cont) {\r\n        this.cont = cont;\r\n    }\r\n    public String getIdventa() {\r\n        return idventa;\r\n    }\r\n\r\n    public void setIdventa(String idventa) {\r\n        this.idventa = idventa;\r\n    }\r\n\r\n    public String getIdpro() {\r\n        return idpro;\r\n    }\r\n\r\n    public void setIdpro(String idpro) {\r\n        this.idpro = idpro;\r\n    }\r\n\r\n    public String getNombre() {\r\n        return nombre;\r\n    }\r\n\r\n    public void setNombre(String nombre) {\r\n        this.nombre = nombre;\r\n    }\r\n\r\n    public Integer getCantidad() {\r\n        return cantidad;\r\n    }\r\n\r\n    public void setCantidad(Integer cantidad) {\r\n        this.cantidad = cantidad;\r\n    }\r\n\r\n    public Float getPrecio() {\r\n        return precio;\r\n    }\r\n\r\n    public void setPrecio(Float precio) {\r\n        this.precio = precio;\r\n    }\r\n Integer cantidad;\r\n Float precio;\r\nResultSet resultado;\r\n   JIFrmCompra compra;\r\n    MBD cnn=new MBD();\r\n  public ClsMCompra(JIFrmCompra _productos) {\r\n        this.compra = _productos;\r\n    }\r\n \r\n \r\n    public String getBuscar() {\r\n        return buscar;\r\n    }\r\n\r\n    public void setBuscar(String buscar) {\r\n        this.buscar = buscar;\r\n    }\r\n     Object[][] dat;\r\n     public DefaultTableModel llenartabla()\r\n  {\r\n      DefaultTableModel dato=null;\r\n      try\r\n      {\r\n          String[] titulos={\"CLAVE\",\"NOMBRE\",\"EXISTENCIA\",\"DECRIPCION\",\"MARCA\",\"CATEGORIA\",\"ESTADO\",\"PRECIO MENU\",\"PRECIO MAYOREO\"};\r\n          String consulta;\r\n          consulta = \"select * from tblproductos\";\r\n          String[] columnas={\"vch_id_producto\",\"vch_nombre\",\"int_existencia\",\"vch_descripcion\",\"vch_id_marca\",\"vch_id_categoria\",\"vch_estado\",\"flt_precio_menu\",\"flt_precio_mayo\"};\r\n          dat= cnn.getDatos(consulta, columnas);\r\n          dato= new DefaultTableModel(dat,titulos);\r\n      }catch(Exception ex){}\r\n      return dato;\r\n  }\r\n    \r\n   public boolean BuscarProducto() throws ClassNotFoundException\r\n   {\r\n       boolean ban=false;\r\n       try {\r\n            String[] titulos={\"CLAVE\",\"NOMBRE\",\"EXISTENCIA\",\"DECRIPCION\",\"MARCA\",\"CATEGORIA\",\"ESTADO\",\"PRECIO MENU\",\"PRECIO MAYOREO\"};\r\n            DefaultTableModel table = new DefaultTableModel();\r\n            resultado = cnn.Consulta_SET(\"select * from tblproductos where vch_id_producto = '\"+this.getBuscar()+\"'\");\r\n            int filas=0,columna=9,i=0;\r\n            while(resultado.next())\r\n            {\r\n                filas++;\r\n            }\r\n            resultado.close();\r\n            resultado =cnn.Consulta_SET(\"select * from tblproductos where vch_id_producto = '\"+this.getBuscar()+\"'\");\r\n            java.lang.Object[][] matriz = new String[filas][columna];\r\n            while(resultado.next())\r\n            {\r\n                matriz[i][0]=resultado.getString(\"vch_id_producto\");\r\n                matriz[i][1]=resultado.getString(\"vch_nombre\");\r\n                matriz[i][2]=resultado.getString(\"int_existencia\");\r\n                matriz[i][3]=resultado.getString(\"vch_descripcion\");\r\n                matriz[i][4]=resultado.getString(\"vch_id_marca\");\r\n                matriz[i][5]=resultado.getString(\"vch_id_categoria\");\r\n                matriz[i][6]=resultado.getString(\"vch_estado\");\r\n                matriz[i][7]=resultado.getString(\"flt_precio_menu\");\r\n                matriz[i][8]=resultado.getString(\"flt_precio_mayo\");\r\n                i++;\r\n                if(i==0){\r\n                    ban=false;\r\n                }\r\n                else{\r\n                    ban=true;}\r\n            }\r\n            resultado.close();\r\n            table.setDataVector(matriz,titulos);\r\n            this.compra.jtblProductos.setModel(table);\r\n\r\n        } \r\n        catch (SQLException ex) { ban= false;}\r\n       return ban;\r\n   }\r\n   DefaultTableModel model;\r\n    public void AgregarTablaProducto()\r\n   {\r\n\r\n       if(this.getCantidad()>this.getExistencia()){\r\n           JOptionPane.showMessageDialog(null, \"No hay producctos suficientes\");\r\n       }else{\r\n            if(!(this.getExistencia()<=0)){\r\n                 int cant = this.getCantidad();\r\n                double preU = this.getPrecio();\r\n                double tProduc = cant * preU;\r\n                model = (DefaultTableModel) this.compra.jtblOrden.getModel();\r\n            \r\n                Object registro[] = {this.getIdventa(),this.getIdpro(),cant,preU,tProduc};\r\n                model.addRow(registro);\r\n             }\r\n             else{\r\n                 JOptionPane.showMessageDialog(null,\"No hay suficientes productos\");\r\n             }\r\n       }\r\n            \r\n   }\r\n     public void cobrar(){\r\n\r\n        double subT=0;\r\n         int tam = compra.jtblOrden.getRowCount();\r\n        for(int i=0; i<tam;i++)\r\n        {\r\n            String s = String.valueOf(compra.jtblOrden.getValueAt(i, 4));\r\n            double p =Double.parseDouble(s);\r\n            subT = subT + p;\r\n        }\r\n        double iva = subT*0.16;\r\n        double Total = subT+iva;\r\n        compra.jtxtSubtotal.setText(String.valueOf(subT));\r\n        compra.jtxtIVA.setText(String.valueOf(iva));\r\n        compra.jtxtTotal.setText(String.valueOf(Total));\r\n        }\r\n    public void CargarCombos() throws ClassNotFoundException\r\n   {\r\n        try {\r\n            DefaultComboBoxModel modeloCombo1 = new DefaultComboBoxModel();\r\n            resultado= cnn.Consulta_SET(\"SELECT * FROM TBLPROVEEDOR\");\r\n            while (resultado.next())\r\n            {  \r\n                modeloCombo1.addElement(resultado.getObject(\"VCH_NOMBRE_PRO\"));     \r\n            }      \r\n            this.compra.jcmbProveedor.setModel(modeloCombo1);\r\n            resultado.close(); \r\n        } catch (SQLException ex) {\r\n            Logger.getLogger(ClsMProductos.class.getName()).log(Level.SEVERE, null, ex);\r\n        }\r\n   }\r\n    ResultSet iprove,idprod;\r\n   jClsCompra co;\r\n    public void guardarCompra() throws SQLException, ClassNotFoundException, Exception{\r\n        iprove=cnn.Consulta_SET(\"SELECT vch_id_proveedor from tblproveedor where vch_nombre_pro='\"+this.getIdprove()+\"'\");\r\n            \r\n            iprove.next();\r\n                canAgregar=compra.jtblOrden.getRowCount();\r\n                cnn.procesos(\"insert into tblcompra(flt_total,vch_id_empleado,vch_id_proveedor) values(\"+Float.parseFloat(this.compra.jtxtTotal.getText())+\",'\"+this.em.toString()+\"','\"+this.iprove.getString(\"vch_id_proveedor\")+\"')\");\r\nfor(int i=0;i<canAgregar;i++){\r\n          cnn.procesos(\"begin sp_inserta_compradeta ('\"+this.getIdventa()+\"',\"+Integer.parseInt((String) this.compra.jtblOrden.getValueAt(i, 2))+\",\"+Float.parseFloat((String) this.compra.jtblOrden.getValueAt(i, 4))+\",'\"+this.compra.jtblOrden.getValueAt(i, 1)+\"'); commit; end;\");\r\n      }\r\n    }\r\n   \r\n    \r\n   \r\n\r\n"
        }
    ]
}